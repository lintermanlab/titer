<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate maxRBA — Calculate_maxRBA • titer</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">titer</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/stefanavey/titer">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate maxRBA</h1>
    </div>

    
    <p><code>Calculate_maxRBA</code> calculates the maximum residual after baseline-adjustment for each viral strain</p>
    

    <pre class="usage"><span class='fu'>Calculate_maxRBA</span>(<span class='no'>dat_list</span>, <span class='kw'>subjectCol</span> <span class='kw'>=</span> <span class='st'>"SubjectID"</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"exp"</span>,
  <span class='st'>"lm"</span>), <span class='kw'>yMinZero</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>scoreFun</span> <span class='kw'>=</span> <span class='no'>max</span>, <span class='kw'>discretize</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0.2</span>, <span class='fl'>0.3</span>),
  <span class='kw'>normalize</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>scaleResiduals</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>responseLabels</span> <span class='kw'>=</span> <span class='fu'>paste0</span>(<span class='fu'>c</span>(<span class='st'>"low"</span>, <span class='st'>"moderate"</span>, <span class='st'>"high"</span>), <span class='st'>"Responder"</span>),
  <span class='kw'>na_action</span> <span class='kw'>=</span> <span class='st'>"na.fail"</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dat_list</th>
      <td><p>a named list like the one returned by <code><a href='FormatTiters.html'>FormatTiters</a></code>.</p></td>
    </tr>
    <tr>
      <th>subjectCol</th>
      <td><p>the name of the column specifying a subject ID. Default is "SubjectID".</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>a character string specifying the method used to model the relationship between day 0 and fold change values. One of either "lm" for a linear model or "exp" for an exponential model.</p></td>
    </tr>
    <tr>
      <th>yMinZero</th>
      <td><p>a logical specifying whether fitted y values below 0 should be set to 0.</p></td>
    </tr>
    <tr>
      <th>scoreFun</th>
      <td><p>a function applied to all (potentially scaled) residuals for each subject to determine the endpoint. Default is <code>max</code> but <code>sum</code> may also be useful to quantify the total response.</p></td>
    </tr>
    <tr>
      <th>discretize</th>
      <td><p>a vector of quantiles in (0, 0.5] specifying where to make the cutoff for low, moderate and high responses. Default is 20% and 30%.</p></td>
    </tr>
    <tr>
      <th>normalize</th>
      <td><p>Logical specifying whether residuals should be normalized with the inverse normal transform. Default is <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>scaleResiduals</th>
      <td><p>Logical. Should residuals be scaled inversely by the
square of the confidence intervals from the linear model.</p></td>
    </tr>
    <tr>
      <th>responseLabels</th>
      <td><p>names for low, moderate and high responses</p></td>
    </tr>
    <tr>
      <th>na_action</th>
      <td><p>how should missing <code>NA</code> values be treated. Default is "na.fail"</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code>lm</code> if method == "lm" or <code>nls</code> if method == "exp"</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Calculates the baseline-adjusted fold change for each strain of virus
using (unnormalized) fold change and baseline titers. Linear regression or
an exponential curve is used to remove the effect of baseline titers on fold changes.
The score function (<code>scoreFun</code>) is used to combine the adjusted fold change across
multiple strains.
Missing (<code>NA</code>) values are handled by being returned as missing in the
endpoints in the output</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code>lm, nls</code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Prepare the data</span>
<span class='no'>titer_list</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FormatTiters.html'>FormatTiters</a></span>(<span class='no'>Year2_Titers</span>)</div><div class='output co'>#&gt; <span class='message'>- Log transforming Pre and Post columns</span></div><div class='output co'>#&gt; <span class='message'>- Setting any negative log fold changes to 0</span></div><div class='input'>
<span class='co'>## Using a linear fit</span>
<span class='no'>endpoints</span> <span class='kw'>&lt;-</span> <span class='fu'>Calculate_maxRBA</span>(<span class='no'>titer_list</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"lm"</span>)
<span class='fu'>summary</span>(<span class='no'>endpoints</span>)</div><div class='output co'>#&gt;                Length Class  Mode   
#&gt; models           3    -none- list   
#&gt; residualMatrix 207    -none- numeric
#&gt; maxRBA          69    -none- numeric
#&gt; maxRBA_d20      69    factor numeric
#&gt; maxRBA_d30      69    factor numeric</div><div class='input'><span class='co'>## Get discrete endpoints using upper/lower 30%</span>
<span class='no'>endpoints</span>$<span class='no'>maxRBA_d30</span></div><div class='output co'>#&gt;            110191            110192            110193            110194 
#&gt;      lowResponder      lowResponder      lowResponder      lowResponder 
#&gt;            110195            110196            110197            110198 
#&gt; moderateResponder      lowResponder     highResponder      lowResponder 
#&gt;            110199            110200            110201            110202 
#&gt;      lowResponder moderateResponder     highResponder moderateResponder 
#&gt;            110203            110204            110205            110207 
#&gt; moderateResponder moderateResponder moderateResponder      lowResponder 
#&gt;            110208            110209            110210            110211 
#&gt;      lowResponder      lowResponder      lowResponder     highResponder 
#&gt;            110212            110213            110214            110215 
#&gt;      lowResponder moderateResponder moderateResponder moderateResponder 
#&gt;            110216            110241            110242            110243 
#&gt;     highResponder     highResponder moderateResponder      lowResponder 
#&gt;            110244            110245            110247            110248 
#&gt;     highResponder moderateResponder     highResponder      lowResponder 
#&gt;            110250            110251            110252            110253 
#&gt; moderateResponder     highResponder     highResponder moderateResponder 
#&gt;            110254            110255            110256            110257 
#&gt; moderateResponder moderateResponder     highResponder     highResponder 
#&gt;            110258            110259            110260            110261 
#&gt; moderateResponder     highResponder      lowResponder moderateResponder 
#&gt;            110262            110263            110264            110265 
#&gt;     highResponder moderateResponder      lowResponder     highResponder 
#&gt;            110266            110267            110268            110269 
#&gt;     highResponder     highResponder     highResponder moderateResponder 
#&gt;            110270            110271            110272            110273 
#&gt; moderateResponder moderateResponder     highResponder moderateResponder 
#&gt;            110274            110275            110276            110277 
#&gt; moderateResponder     highResponder     highResponder     highResponder 
#&gt;            110278            110279            110280            110281 
#&gt;      lowResponder      lowResponder moderateResponder      lowResponder 
#&gt;            110282            110283            110284            110285 
#&gt; moderateResponder moderateResponder      lowResponder      lowResponder 
#&gt;            110286 
#&gt; moderateResponder 
#&gt; Levels: lowResponder moderateResponder highResponder</div><div class='input'>
<span class='co'>## Get endpoints with a 50% split into high and low</span>
<span class='no'>endpoints</span> <span class='kw'>&lt;-</span> <span class='fu'>Calculate_maxRBA</span>(<span class='no'>titer_list</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"exp"</span>, <span class='kw'>discretize</span> <span class='kw'>=</span> <span class='fl'>0.5</span>)
<span class='no'>endpoints</span>$<span class='no'>maxRBA_d50</span></div><div class='output co'>#&gt;        110191        110192        110193        110194        110195 
#&gt;  lowResponder  lowResponder  lowResponder  lowResponder highResponder 
#&gt;        110196        110197        110198        110199        110200 
#&gt;  lowResponder highResponder  lowResponder  lowResponder highResponder 
#&gt;        110201        110202        110203        110204        110205 
#&gt; highResponder highResponder highResponder highResponder highResponder 
#&gt;        110207        110208        110209        110210        110211 
#&gt;  lowResponder  lowResponder  lowResponder  lowResponder highResponder 
#&gt;        110212        110213        110214        110215        110216 
#&gt;  lowResponder highResponder  lowResponder  lowResponder highResponder 
#&gt;        110241        110242        110243        110244        110245 
#&gt; highResponder  lowResponder  lowResponder highResponder highResponder 
#&gt;        110247        110248        110250        110251        110252 
#&gt; highResponder  lowResponder  lowResponder highResponder highResponder 
#&gt;        110253        110254        110255        110256        110257 
#&gt; highResponder highResponder highResponder highResponder highResponder 
#&gt;        110258        110259        110260        110261        110262 
#&gt; highResponder highResponder  lowResponder highResponder highResponder 
#&gt;        110263        110264        110265        110266        110267 
#&gt;  lowResponder  lowResponder highResponder highResponder highResponder 
#&gt;        110268        110269        110270        110271        110272 
#&gt; highResponder highResponder  lowResponder  lowResponder highResponder 
#&gt;        110273        110274        110275        110276        110277 
#&gt;  lowResponder  lowResponder highResponder highResponder highResponder 
#&gt;        110278        110279        110280        110281        110282 
#&gt;  lowResponder  lowResponder  lowResponder  lowResponder  lowResponder 
#&gt;        110283        110284        110285        110286 
#&gt; highResponder  lowResponder  lowResponder  lowResponder 
#&gt; Levels: lowResponder moderateResponder highResponder</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Stefan Avey

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Stefan Avey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
